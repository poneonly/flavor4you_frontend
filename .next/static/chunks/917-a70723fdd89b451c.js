"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[917],{4917:(e,i,t)=>{t.d(i,{A:()=>R});var r=t(6166),l=t(5766),n=t(2656),a=t(7941),o=t(3987),s=t(8878);function c(e){let{kind:i="primary",children:t,sx:l,size:n="large",...a}=e,o="primary"===i;return(0,r.jsx)(s.A,{variant:o?"contained":"outlined",color:"inherit",size:n,sx:{textTransform:"none",...o?{backgroundColor:"var(--color-primary)",color:"#fff",border:"1px solid var(--color-primary)","&:hover":{backgroundColor:"var(--color-primary)",opacity:.9,border:"1px solid var(--color-primary)"}}:{backgroundColor:"#fff",color:"var(--color-primary)",border:"1px solid var(--color-primary)","&:hover":{backgroundColor:"#fff",border:"1px solid var(--color-primary)",opacity:.9}},...l},...a,children:t})}var d=t(5113),u=t(9618),p=t(2743),h=t(7704),x=t(9534),g=t(3449);let f=(0,x.Z)();function m(e){let{value:i,onChange:t,errors:n}=e,{title:a,description:s,categories:c}=i,[d,x]=l.useState([]);l.useEffect(()=>{fetch("/categories.json").then(e=>e.json()).then(e=>{x(e.map(e=>e.name))}).catch(console.error)},[]);let m=async e=>{let r=e.filter(e=>!d.some(i=>i.toLowerCase()===e.toLowerCase()));if(r.length){for(let e of r)await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})});let e=await fetch("/api/categories");x((await e.json()).map(e=>e.name))}t({...i,categories:e})};return(0,r.jsxs)(u.A,{variant:"outlined",sx:{p:3},children:[(0,r.jsx)(p.A,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Basic Information"}),(0,r.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,r.jsx)(h.A,{fullWidth:!0,label:"Recipe Name",value:a,onChange:e=>t({...i,title:e.target.value}),error:!!(null==n?void 0:n.title),helperText:null==n?void 0:n.title}),(0,r.jsx)(h.A,{fullWidth:!0,label:"Description",multiline:!0,rows:2,value:s,onChange:e=>t({...i,description:e.target.value}),error:!!(null==n?void 0:n.description),helperText:null==n?void 0:n.description}),(0,r.jsx)(g.A,{multiple:!0,freeSolo:!0,options:d,value:c,filterOptions:(e,i)=>{let t=f(e,i),{inputValue:r}=i;return""===r||e.some(e=>e.toLowerCase()===r.toLowerCase())||t.push(r),t},onChange:(e,i)=>m(i),renderInput:e=>(0,r.jsx)(h.A,{...e,label:"Categories",error:!!(null==n?void 0:n.categories),helperText:null==n?void 0:n.categories})})]})]})}function v(e){let{value:i,onChange:t}=e,n=l.useRef(null),[a,s]=l.useState(!1),d=async e=>{var i;if(!(null==(i=e.target.files)?void 0:i.length))return;let r=e.target.files[0],l=new FormData;l.append("file",r),s(!0);try{let e=await fetch("/api/upload",{method:"POST",body:l}),i=await e.json();t(i.url)}catch(e){console.error(e)}finally{s(!1)}};return(0,r.jsxs)(u.A,{variant:"outlined",sx:{p:3},children:[(0,r.jsx)(p.A,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Upload Recipe Image"}),(0,r.jsxs)(o.A,{sx:{border:"2px dashed #ccc",borderRadius:2,height:180,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},onClick:()=>{var e;return null==(e=n.current)?void 0:e.click()},children:[(0,r.jsx)(c,{kind:"secondary",children:a?"Uploading...":"Upload Image"}),(0,r.jsx)("input",{type:"file",hidden:!0,ref:n,onChange:d,accept:"image/*"})]}),i&&(0,r.jsxs)(o.A,{sx:{mt:2},children:[(0,r.jsx)(p.A,{variant:"body2",color:"text.secondary",children:"Current image:"}),(0,r.jsx)(o.A,{component:"img",src:i,alt:"recipe",sx:{mt:1,width:"100%",maxHeight:220,objectFit:"cover",borderRadius:1}})]})]})}var j=t(2468);function y(e){let{value:i,onChange:t,showErrors:n,errorText:s}=e,[d,x]=l.useState(""),[g,f]=l.useState("");return(0,r.jsxs)(u.A,{variant:"outlined",sx:{p:3},children:[(0,r.jsx)(p.A,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Ingredients"}),(0,r.jsxs)(a.A,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",children:[(0,r.jsx)(h.A,{label:"Ingredient name",fullWidth:!0,value:d,onChange:e=>x(e.target.value)}),(0,r.jsx)(h.A,{label:"Quantity (e.g., 2 cups)",fullWidth:!0,value:g,onChange:e=>f(e.target.value)}),(0,r.jsx)(c,{kind:"primary",onClick:()=>{d.trim()&&g.trim()&&(t([...i,{ingredientName:d.trim(),quantity:g.trim()}]),x(""),f(""))},type:"button",children:"Add"})]}),n&&!!s&&(0,r.jsx)(p.A,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:s}),(0,r.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:2},children:i.map((e,l)=>(0,r.jsx)(j.A,{label:"".concat(e.quantity," ").concat(e.ingredientName),onDelete:()=>(e=>{let r=[...i];r.splice(e,1),t(r)})(l)},"".concat(e.ingredientName,"-").concat(e.quantity,"-").concat(l)))})]})}var b=t(1851),A=t(7727);function C(e){let{value:i,onChange:t,showErrors:n}=e,[s,d]=l.useState(i.length?i:[""]);l.useEffect(()=>{d(i.length?i:[""])},[i]);let x=e=>{d(e),t(e)};return(0,r.jsxs)(u.A,{variant:"outlined",sx:{p:3},children:[(0,r.jsx)(p.A,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Directions"}),(0,r.jsx)(a.A,{spacing:2,children:s.map((e,i)=>{let t=!!n&&""===e.trim();return(0,r.jsxs)(o.A,{sx:{p:1,borderRadius:1,border:"1px solid",borderColor:"divider"},children:[(0,r.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,r.jsxs)(p.A,{fontWeight:"bold",children:["Step ",i+1]}),i>0&&(0,r.jsx)(b.A,{"aria-label":"remove step",size:"small",onClick:()=>{var e;0!==(e=i)&&x(s.filter((i,t)=>t!==e))},sx:{ml:"auto"},children:(0,r.jsx)(A.A,{size:16})})]}),(0,r.jsx)(h.A,{fullWidth:!0,multiline:!0,rows:3,placeholder:"Describe step...",value:e,onChange:e=>{var t;return t=e.target.value,void x(s.map((e,r)=>r===i?t:e))},error:t,helperText:t?"This step cannot be empty.":void 0})]},i)})}),(0,r.jsx)(o.A,{sx:{mt:2,display:"flex",justifyContent:"center"},children:(0,r.jsx)(c,{kind:"primary",onClick:()=>x([...s,""]),children:"Add Step"})})]})}var k=t(3602),w=t(4553),S=t(1907),T=t(313);function W(e){let{value:i,onChange:t,errors:l}=e,{cookTime:n,servings:a,difficulty:s}=i;return(0,r.jsxs)(u.A,{variant:"outlined",sx:{p:3},children:[(0,r.jsx)(p.A,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Recipe Details"}),(0,r.jsxs)(o.A,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,r.jsx)(h.A,{label:"Cook Time (minutes)",type:"number",sx:{flex:1,minWidth:200},value:n,onChange:e=>t({...i,cookTime:e.target.value}),error:!!(null==l?void 0:l.cookTime),helperText:null==l?void 0:l.cookTime,inputProps:{min:0}}),(0,r.jsx)(h.A,{label:"Servings (people)",type:"number",sx:{flex:1,minWidth:200},value:a,onChange:e=>t({...i,servings:e.target.value}),error:!!(null==l?void 0:l.servings),helperText:null==l?void 0:l.servings,inputProps:{min:1}}),(0,r.jsxs)(k.A,{sx:{flex:1,minWidth:200},error:!!(null==l?void 0:l.difficulty),children:[(0,r.jsx)(w.A,{id:"difficulty-label",children:"Difficulty Level"}),(0,r.jsxs)(S.A,{labelId:"difficulty-label",label:"Difficulty Level",value:s,onChange:e=>t({...i,difficulty:e.target.value}),children:[(0,r.jsx)(T.A,{value:"easy",children:"Easy"}),(0,r.jsx)(T.A,{value:"medium",children:"Medium"}),(0,r.jsx)(T.A,{value:"hard",children:"Hard"})]})]}),(null==l?void 0:l.difficulty)&&(0,r.jsx)(p.A,{variant:"caption",color:"error",sx:{ml:1,mt:.5,width:"100%"},children:l.difficulty})]})]})}function R(e){let{recipe:i}=e,t=(0,d.useRouter)(),[s,u]=l.useState({title:"",description:"",categories:[]}),[p,h]=l.useState([]),[x,g]=l.useState([]),[f,j]=l.useState({cookTime:"",servings:"",difficulty:""}),[b,A]=l.useState(""),[k,w]=l.useState({}),[S,T]=l.useState(!1),R=async()=>{if(T(!0),!(()=>{var e,i,t,r,l,n;let a={};return s.title||((null!=(e=a.basic)?e:a.basic={}).title="Required"),s.description||((null!=(i=a.basic)?i:a.basic={}).description="Required"),s.categories.length||((null!=(t=a.basic)?t:a.basic={}).categories="Required"),p.length||(a.ingredients="At least one ingredient required"),x.length||(a.steps="At least one step required"),f.cookTime||((null!=(r=a.details)?r:a.details={}).cookTime="Required"),f.servings||((null!=(l=a.details)?l:a.details={}).servings="Required"),f.difficulty||((null!=(n=a.details)?n:a.details={}).difficulty="Required"),b||(a.image="Image required"),w(a),0===Object.keys(a).length})())return;let e={title:s.title.trim(),description:s.description.trim(),categories:s.categories,cookingTime:Number(f.cookTime),servings:Number(f.servings),difficulty:f.difficulty,recipeImages:b,ingredients:p,steps:x};try{let i=await fetch("/api/recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await i.json();i.ok&&(null==r?void 0:r.id)?t.push("/recipes/".concat(r.id)):alert("Save failed: "+JSON.stringify(r))}catch(e){console.error(e)}};return(0,r.jsxs)(n.A,{maxWidth:"md",sx:{py:6},children:[(0,r.jsxs)(a.A,{spacing:4,children:[(0,r.jsx)(m,{value:s,onChange:u,errors:k.basic}),(0,r.jsx)(v,{value:b,onChange:A}),(0,r.jsx)(y,{value:p,onChange:h,showErrors:S,errorText:k.ingredients}),(0,r.jsx)(C,{value:x,onChange:g,showErrors:S}),(0,r.jsx)(W,{value:f,onChange:j,errors:k.details})]}),(0,r.jsx)(o.A,{sx:{mt:5,display:"flex",justifyContent:"center",gap:3},children:(0,r.jsx)(c,{kind:"primary",onClick:R,children:"Publish Recipe"})})]})}}}]);